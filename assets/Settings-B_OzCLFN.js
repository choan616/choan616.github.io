const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D7dpN-ot.js","assets/vendor-ui-CGZmARxJ.js","assets/vendor-react-qkC6yhPU.js","assets/vendor-utils-BGkSQjfT.js","assets/vendor-db-CzqAUFpF.js","assets/index-M1U_o6Fo.css"])))=>i.map(i=>d[i]);
import{b as f,c as w,d as k,j as e,_ as I}from"./index-D7dpN-ot.js";import{r as x}from"./vendor-ui-CGZmARxJ.js";import"./vendor-react-qkC6yhPU.js";import"./vendor-db-CzqAUFpF.js";import"./vendor-utils-BGkSQjfT.js";function P({onClose:n}){const{currentUserId:l,isNewUser:i,setIsNewUser:j,unlock:h}=f(),{currentUser:a}=w(),[t,g]=x.useState(""),[m,c]=x.useState(""),s=k(),r=!!n;if(console.log("[PasswordSetupModal] 렌더링 조건 확인:",{currentAuthUserId:s,isInvokedFromSettings:r,isNewUser:i,shouldRender:!!(s&&(r||i))}),!s||!r&&!i)return null;const N=o=>{const d=o.target.value.replace(/\D/g,"").slice(0,4);g(d),c("")},v=async o=>{if(o.preventDefault(),!/^\d{4}$/.test(t)){c("4자리 숫자 PIN을 입력하세요.");return}try{const{setPin:d}=await I(async()=>{const{setPin:b}=await import("./index-D7dpN-ot.js").then(y=>y.e);return{setPin:b}},__vite__mapDeps([0,1,2,3,4,5]));await d(s,t),j(!1),h(),alert("PIN이 설정되었습니다."),n&&n()}catch(d){console.error("PIN 설정 실패:",d),c("PIN 설정 중 오류가 발생했습니다.")}};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",onClick:o=>o.stopPropagation(),children:[n&&e.jsx("button",{onClick:n,className:"close-btn",style:{position:"absolute",top:"1rem",right:"1rem"},children:"✕"}),e.jsx("h3",{children:"보안 PIN 설정"}),e.jsx("p",{children:"서비스 이용을 위해 4자리 PIN을 설정해주세요. (기기 간 동기화)"}),e.jsxs("form",{onSubmit:v,children:[e.jsx("input",{inputMode:"numeric",pattern:"\\d{4}",value:t,onChange:N,placeholder:"0000",autoFocus:!0}),m&&e.jsx("div",{className:"error styled-error",children:m}),e.jsx("button",{type:"submit",children:"설정"})]})]})})}const p="app_settings",S={autoSyncEnabled:!1,syncInterval:30,wifiOnly:!1,syncOnSave:!0,fontSize:"medium",theme:"system",enableScreenLock:!0};function _({isGuest:n,onClose:l,showToast:i}){const[j,h]=x.useState(!1),[a,t]=x.useState(()=>{try{const s=localStorage.getItem(p);if(s)return{...S,...JSON.parse(s)}}catch(s){console.error("Failed to load settings:",s)}return S}),g=(s,r)=>{const N=Number(r);t(v=>({...v,[s]:N}))},m=async()=>{try{localStorage.setItem(p,JSON.stringify(a)),window.dispatchEvent(new CustomEvent("settings-updated")),i("설정이 저장되었습니다.","success"),l()}catch(s){console.error("설정 저장 실패:",s),i("설정 저장에 실패했습니다.","error")}},c=()=>h(!0);return e.jsxs("div",{className:"settings-overlay",children:[e.jsxs("div",{className:"settings-modal",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h2",{children:"설정"}),e.jsx("button",{onClick:l,className:"close-btn","aria-label":"닫기",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M18 6 6 18"}),e.jsx("path",{d:"m6 6 12 12"})]})})]}),e.jsxs("div",{className:"settings-content",children:[e.jsxs("div",{className:"settings-section",children:[e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{htmlFor:"autoSyncEnabled",className:"setting-label",children:"자동 동기화"}),e.jsx("span",{className:"setting-desc",children:"앱을 사용하지 않을 때도 주기적으로 데이터를 동기화합니다."})]}),e.jsx(u,{id:"autoSyncEnabled",checked:a.autoSyncEnabled,onChange:()=>t(s=>({...s,autoSyncEnabled:!s.autoSyncEnabled}))})]}),a.autoSyncEnabled&&e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{htmlFor:"syncInterval",className:"setting-label",children:"동기화 주기"}),e.jsx("span",{className:"setting-desc",children:"자동 동기화가 실행되는 간격입니다."})]}),e.jsxs("select",{id:"syncInterval",value:a.syncInterval,onChange:s=>g("syncInterval",s.target.value),className:"setting-select",children:[e.jsx("option",{value:5,children:"5분"}),e.jsx("option",{value:15,children:"15분"}),e.jsx("option",{value:30,children:"30분"}),e.jsx("option",{value:60,children:"1시간"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{htmlFor:"syncOnSave",className:"setting-label",children:"저장 시 동기화"}),e.jsx("span",{className:"setting-desc",children:"일기를 저장할 때마다 자동으로 동기화를 실행합니다."})]}),e.jsx(u,{id:"syncOnSave",checked:a.syncOnSave,onChange:()=>t(s=>({...s,syncOnSave:!s.syncOnSave}))})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{htmlFor:"wifiOnly",className:"setting-label",children:"Wi-Fi에서만 동기화"}),e.jsx("span",{className:"setting-desc",children:"모바일 데이터 사용을 절약하기 위해 Wi-Fi 연결 시에만 동기화합니다."})]}),e.jsx(u,{id:"wifiOnly",checked:a.wifiOnly,onChange:()=>t(s=>({...s,wifiOnly:!s.wifiOnly}))})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h3",{children:"보안"}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{className:"setting-label",children:"PIN 변경/설정"}),e.jsx("span",{className:"setting-desc",children:"앱 잠금에 사용할 4자리 PIN을 설정하거나 변경합니다."})]}),e.jsx("button",{className:"btn btn-secondary",onClick:c,children:"PIN 설정"})]}),!n&&e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{htmlFor:"enableScreenLock",className:"setting-label",children:"화면 잠금 사용"}),e.jsx("span",{className:"setting-desc",children:"PIN이 설정된 경우, 일정 시간 미사용 시 화면을 잠급니다."})]}),e.jsx(u,{id:"enableScreenLock",checked:a.enableScreenLock,onChange:()=>t(s=>({...s,enableScreenLock:!s.enableScreenLock}))})]})]}),e.jsx("div",{className:"settings-footer",children:e.jsxs("button",{onClick:m,className:"btn btn-primary",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),e.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"저장"]})})]})]}),j&&e.jsx(P,{onClose:()=>h(!1)})]})}function u({id:n,checked:l,onChange:i}){return e.jsxs("label",{htmlFor:n,className:"switch",children:[e.jsx("input",{type:"checkbox",id:n,checked:l,onChange:i}),e.jsx("span",{className:"slider round"})]})}export{_ as Settings};
